<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Permissions</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1 class="title">Checking Permissions</h1>
        <div id="linkContainer" class="generated-link"></div>
        <br><br>
        <button onclick="copyLink()" class="btn">Copy Link</button>
        <br><br>
        <button onclick="goBack()" class="btn back-button">Back</button>
    </div>

    <script>
        // Retrieve the generated link from the URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const generatedLink = urlParams.get('link');

        // Insert line breaks into the generated link
        const wrappedLink = generatedLink.replace(/(.{50})/g, "$1<br>");

        // Set the wrapped link as the content of the linkContainer element
        document.getElementById("linkContainer").innerHTML = wrappedLink;

        // Function to copy the generated link to the clipboard
        function copyLink() {
            const linkToCopy = generatedLink;

            // Copy the link to the clipboard
            navigator.clipboard.writeText(linkToCopy)
                .then(() => {
                    alert("Link copied to clipboard: " + linkToCopy);
                })
                .catch((error) => {
                    console.error("Error copying link to clipboard:", error);
                    alert("Failed to copy link to clipboard. Please try again.");
                });

            // Redirect to retrievedClient.html after consent
            window.location.href = "retrievedClient.html";
        }

        // Function to navigate back
        function goBack() {
            window.history.back(); // Go back to the previous page
        }
    </script>
</body>
</html>
